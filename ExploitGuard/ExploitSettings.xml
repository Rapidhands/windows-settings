<?xml version="1.0" encoding="UTF-8"?>
<MitigationPolicy>
  <SystemConfig>
    <!-- All system mitigations enabled -->
    <DEP Enable="true" EmulateAtlThunks="false" />
    <ASLR BottomUp="true" HighEntropy="true" />
    <ControlFlowGuard Enable="true" SuppressExports="false" />
    <SEHOP Enable="true" TelemetryOnly="false" />
    <Heap TerminateOnError="true" />
  </SystemConfig>
  <!-- 7-zip -->
  <AppConfig Executable="7z.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <SignedBinaries EnforceModuleDependencySigning="true" />
  </AppConfig>
  <AppConfig Executable="7zFM.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <SignedBinaries EnforceModuleDependencySigning="true" />
  </AppConfig>
  <AppConfig Executable="7zG.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <SignedBinaries EnforceModuleDependencySigning="true" />
  </AppConfig>
  <!-- Winrar -->
  <AppConfig Executable="winrar.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <SignedBinaries EnforceModuleDependencySigning="true" />
  </AppConfig>
  <!-- VLC -->
  <AppConfig Executable="vlc.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <SignedBinaries EnforceModuleDependencySigning="true" />
  </AppConfig>
  <!-- Office -->
  <AppConfig Executable="winword.exe">
    <StrictHandle Enable="true" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <AppConfig Executable="excel.exe">
    <StrictHandle Enable="true" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <AppConfig Executable="powerpnt.exe">
    <StrictHandle Enable="true" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <AppConfig Executable="msaccess.exe">
    <StrictHandle Enable="true" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <AppConfig Executable="outlook.exe">
    <StrictHandle Enable="true" />
    <Fonts DisableNonSystemFonts="true" AuditOnly="false" Audit="false" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <!-- Chrome -->
  <AppConfig Executable="chrome.exe">
    <StrictHandle Enable="true" />
    <ExtensionPoints DisableExtensionPoints="true" />
    <ASLR ForceRelocateImages="true" RequireInfo="true" BottomUp="true" HighEntropy="true" />
  </AppConfig>
  <!-- Edge -->
  <AppConfig Executable="msedge.exe">
    <StrictHandle Enable="true" />
    <ExtensionPoints DisableExtensionPoints="true" />
    <ASLR ForceRelocateImages="true" RequireInfo="true" BottomUp="true" HighEntropy="true" />
  </AppConfig>
  <!-- Firefox -->
  <AppConfig Executable="firefox.exe">
    <StrictHandle Enable="true" />
    <ExtensionPoints DisableExtensionPoints="true" />
    <ASLR ForceRelocateImages="true" RequireInfo="true" BottomUp="true" HighEntropy="true" />
  </AppConfig>
  <!-- Tor -->
  <AppConfig Executable="tor.exe">
    <ChildProcess DisallowChildProcessCreation="true" Audit="false" />
  </AppConfig>
  <!-- qBittorrent  -->
  <AppConfig Executable="qbittorrent.exe">
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <ControlFlowGuard Enable="true" SuppressExports="false" StrictControlFlowGuard="true" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
    <Fonts DisableNonSystemFonts="true" AuditOnly="false" Audit="false" />
    <ImageLoad BlockRemoteImageLoads="true" AuditRemoteImageLoads="false" BlockLowLabelImageLoads="true" AuditLowLabelImageLoads="false" />
  </AppConfig>
  <!-- Windows System  -->
  <AppConfig Executable="C:\Windows\System32\wininit.exe">
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\lsass.exe">
    <ExtensionPoints DisableExtensionPoints="true" />
    <ChildProcess DisallowChildProcessCreation="true" Audit="false" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\winlogon.exe">
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\SecurityHealthService.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\SgrmBroker.exe">
    <SystemCalls DisableWin32kSystemCalls="true" Audit="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\wlanext.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\WUDFHost.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\audiodg.exe">
    <StrictHandle Enable="true" />
    <ChildProcess DisallowChildProcessCreation="true" Audit="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\taskhostw.exe">
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\sihost.exe">
    <StrictHandle Enable="true" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\fontdrvhost.exe">
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
    <Fonts DisableNonSystemFonts="true" AuditOnly="false" Audit="false" />
    <ChildProcess DisallowChildProcessCreation="true" Audit="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\SearchIndexer.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\SearchProtocolHost.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <ChildProcess DisallowChildProcessCreation="true" Audit="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\SearchFilterHost.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <ChildProcess DisallowChildProcessCreation="true" Audit="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\ctfmon.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
    <Fonts DisableNonSystemFonts="true" AuditOnly="false" Audit="false" />
    <ChildProcess DisallowChildProcessCreation="true" Audit="false" />
  </AppConfig>
  <AppConfig Executable="spoolsv.exe">
    <StrictHandle Enable="true" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <AppConfig Executable="svchost.exe">
    <ASLR ForceRelocateImages="true" RequireInfo="true" BottomUp="true" HighEntropy="true" />
    <ControlFlowGuard Enable="true" SuppressExports="true" StrictControlFlowGuard="true" />
    <Fonts DisableNonSystemFonts="true" AuditOnly="false" Audit="false" />
    <ExtensionPoints DisableExtensionPoints="true" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\System32\dasHost.exe">
    <StrictHandle Enable="true" />
    <DynamicCode BlockDynamicCode="true" AllowThreadsToOptOut="false" Audit="false" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <AppConfig Executable="C:\Windows\explorer.exe">
    <StrictHandle Enable="true" />
    <Fonts DisableNonSystemFonts="true" AuditOnly="false" Audit="false" />
  </AppConfig>
  <AppConfig Executable="runtimebroker.exe">
    <ExtensionPoints DisableExtensionPoints="true" />
  </AppConfig>
  <AppConfig Executable="rundll32.exe">
    <ImageLoad BlockRemoteImageLoads="true" AuditRemoteImageLoads="false" BlockLowLabelImageLoads="true" AuditLowLabelImageLoads="false" />
  </AppConfig>
  <AppConfig Executable="Regsvr32.exe">
    <ImageLoad BlockRemoteImageLoads="true" AuditRemoteImageLoads="false" BlockLowLabelImageLoads="true" AuditLowLabelImageLoads="false" />
  </AppConfig>
  <!-- Windows Update -->
  <AppConfig Executable="SetupHost.exe">
    <StrictHandle Enable="false" />
  </AppConfig>
  <!-- OneDrive -->
  <AppConfig Executable="onedrive.exe">
    <StrictHandle Enable="true" />
    <SignedBinaries MicrosoftSignedOnly="true" AllowStoreSignedBinaries="false" Audit="false" AuditStoreSigned="false" />
  </AppConfig>
  <!-- Wireguard -->
  <AppConfig Executable="wireguard.exe">
    <StrictHandle Enable="true" />
    <ASLR ForceRelocateImages="true" BottomUp="true" HighEntropy="true" />
  </AppConfig>
</MitigationPolicy>